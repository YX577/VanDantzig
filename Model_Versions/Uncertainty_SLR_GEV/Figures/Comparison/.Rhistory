polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), rev(1-q[10000:2])), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
year.return
upper_full.90
upper_full.90[10000]
upper_full.90[1]
year.return[1,]
upper_full.90[2]
lower_full.90[2]
polygon(x = c(year.return[,3], (year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(1-q[2:10000], 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
View(upper_full.90)
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(log10(year.return[,3])), (log10(year.return[,1]))), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(log10(2:1000)), log10(2:10000)), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(log10(2:10000)), log10(2:10000)), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(log(2:10000)), log(2:10000)), border = NA, col = "#0080FF40")
log10(2:10000)
e^3
ln(2)
polygon(x = c((year.return[,3]), rev(year.return[,1])), y = c(rev(log10(2:10000)), log10(2:10000)), border = NA, col = "#0080FF40")
0
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(log10(2:10000)), log10(2:10000)), border = NA, col = "#0080FF40")
par('usr')
0^-4
10^-4
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c((log10(2:10000)), rev(log10(2:10000))), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA, col = "#0080FF40")
polygon(x = c(2:10000, 10000:2), y = c(year.return[,3], rev(year.return[,1])), col = "#0080FF40", border = NA)
1-q[2:10000]
log10(q[2])
log(q[2])
polygon(x = c(year.return[,3], (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], (year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
v
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(q[2:10000], q[10000:2]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(q[2:10000], q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(1-q[2:10000], 1-q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[10000:2]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[10000:2]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(y = c(year.return[,3], rev(year.return[,1])), x = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
y
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
year.return[2,3]
1-q[1]
length(year.return[,3])
length(q)
length(q[2:10000])
q[2]
1-q[2]
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,1]), (year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
points(rep(2, 9999), 1-q[2:10000])
points(rep(200, 9999), 1-q[2:10000])
points(rep(200, 9999), 1-q[2:10000], pch = '.')
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(2:10000, 10000:2), y = c(year.return[,3], rev(year.return[,1])), col = "#0080FF40", border = NA)
points(rep(200, 9999), 1-q[2:10000], pch = '.')
plot(q)
plot(year.return[,3], q[2:10000])
lines(upper_full.90, q[2:10000])
lines(upper_full.90[2:10000], q[2:10000])
lines(log10(upper_full.90[2:10000]), q[2:10000])
lines(10^(upper_full.90[2:10000]), q[2:10000])
lines(upper_full.90[2:10000], 10^(q[2:10000]))
lines(upper_full.90[2:10000], log10((q[2:10000]))
)
plot(year.return[,3])
plot(year.return[,3], log = 'x')
plot(year.return[,3])
plot(log10(year.return[,3]))
plot(log(year.return[,3]))
plot(10^(year.return[,3]))
plot(year.return[,3], log = 'x')
polygon(x = c(year.return[,1], rev(year.return[,3])), y = log10(c(rev(1-q[2:10000]), 1-q[2:10000])), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = log10(c(rev(1-q[2:10000]), 1-q[2:10000])), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
return_level_basic(coredata(year.res.max),
10^4, legend = FALSE,
ylim = c(200, 1000),
xlab = "",
xaxs = 'i', yaxs='i',
yaxt =  'n')
axis(2, at = seq(200, 2600, by = 200), labels = seq(2, 26, by = 2), lwd = 1.5, las = 1)
mtext("Return Period [years]", line = 2.5, side = 1)
#polygon(x = c(2:10000, 10000:2), y = c(MC_rl_max2[2:10000], rev(MC_rl_min2[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.35))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.55))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.25))
polygon(x = c(2:10000, 10000:2), y = c(year.return[,3], rev(year.return[,1])), col = "#0080FF40", border = NA)
polygon(x = c(2:10000, 10000:2), y = c(upper.90[2:10000], rev(lower.90[2:10000])), border = NA , col = "#FF666640")
abline(v = 1000)
ablie(h = 1000)
abline(h = 1000)
abline(h = 1/1000)
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(year.return[,1], rev(year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(year.return[,3], rev(year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,1]), (year.return[,3])), y = c(rev(1-q[2:10000]), 1-q[2:10000]), border = NA, col = "#0080FF40")
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
q
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(1:10000)), 1/(1:10000)), border = NA, col = "#0080FF40")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(2:10000)), 1/(2:10000)), border = NA, col = "#0080FF40")
legend("topright",
c("Block maxima observations", "Maximum Likelihood Estimation", "Linear Fit [van Dantzig (1956)]", "MCMC Expected", "Full uncertainty range"),
col = c("black", myblue, "black", myred, "dark gray"),
pch = c(21, NA, NA, NA, 22),
lty = c(NA, 1, 2, 1, NA),
lwd = c(1.5, 2, 2, 2, NA),
pt.bg = c("white", NA, NA, NA, "light gray"),
pt.cex = c(1, NA, NA, NA, 2),
bty = 'n')
legend("topleft",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval"),
col = c("black", myblue, myblue, myred, myred),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640"),
pch = c(21, NA, 22, NA, 22),
lty = c(NA, 1, NA, 1, NA),
lwd = c(1.5, 2, NA, 2, NA),
bty = 'n',
pt.cex = c(1, NA, 2, NA, 2),
inset = c(0.01, -0.01))
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(2:10000)), 1/(2:10000)), border = NA, col = "#0080FF40")
lines(fit_q_year, 1-q, type="l",col=myblue, lwd=2)
lines(MC_full_mean[1:10000], 1-q, col = myred, lwd = 2)
abline(year.res.line, lwd = 1.5, lty = 2)
axis(2, lwd = 1.5, at=10^(seq(-6, -3, by = 1)), label=parse(text=paste("10^", seq(-6,-3, by = 1), sep="")), las = 1)
box(lwd = 1.5)
legend("topright",
c("Block maxima observations", "Maximum Likelihood Estimation", "Linear Fit [van Dantzig (1956)]", "MCMC Expected", "Full uncertainty range"),
col = c("black", myblue, "black", myred, "dark gray"),
pch = c(21, NA, NA, NA, 22),
lty = c(NA, 1, 2, 1, NA),
lwd = c(1.5, 2, 2, 2, NA),
pt.bg = c("white", NA, NA, NA, "light gray"),
pt.cex = c(1, NA, NA, NA, 2),
bty = 'n')
legend('bottomright',
legend="A",
bty = 'n',
cex =1.2,
inset = c(0, -0.01))
legend("topleft",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval"),
col = c("black", myblue, myblue, myred, myred),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640"),
pch = c(21, NA, 22, NA, 22),
lty = c(NA, 1, NA, 1, NA),
lwd = c(1.5, 2, NA, 2, NA),
bty = 'n',
pt.cex = c(1, NA, 2, NA, 2),
inset = c(0.01, -0.01))
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(2:10000)), 1/(2:10000)), border = NA, col = "#0080FF40")
lines(fit_q_year, 1-q, type="l",col=myblue, lwd=2)
lines(MC_full_mean[1:10000], 1-q, col = myred, lwd = 2)
abline(year.res.line, lwd = 1.5, lty = 2)
axis(2, lwd = 1.5, at=10^(seq(-6, -3, by = 1)), label=parse(text=paste("10^", seq(-6,-3, by = 1), sep="")), las = 1)
box(lwd = 1.5)
legend("topright",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval", "Linear Fit [van Dantzig (1956)]"),
col = c("black", myblue, myblue, myred, myred, "black"),
pch = c(21, NA, 22, NA, 22, NA),
lty = c(NA, 1, NA, 1, NA, 2),
lwd = c(1.5, 2, NA, 2, NA, 2),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640", NA),
pt.cex = c(1, NA, 2, NA, 2, NA),
bty = 'n')
pdf("Figures/fig2.return_levels.pdf", width = 6, height = 7.5)
par(oma = c(0,0,0,0)+0.1, mar = c(4,4,1,1), mfrow = c(2,1))
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(2:10000)), 1/(2:10000)), border = NA, col = "#0080FF40")
lines(fit_q_year, 1-q, type="l",col=myblue, lwd=2)
lines(MC_full_mean[1:10000], 1-q, col = myred, lwd = 2)
abline(year.res.line, lwd = 1.5, lty = 2)
axis(2, lwd = 1.5, at=10^(seq(-6, -3, by = 1)), label=parse(text=paste("10^", seq(-6,-3, by = 1), sep="")), las = 1)
box(lwd = 1.5)
legend("topright",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval", "Linear Fit [van Dantzig (1956)]"),
col = c("black", myblue, myblue, myred, myred, "black"),
pch = c(21, NA, 22, NA, 22, NA),
lty = c(NA, 1, NA, 1, NA, 2),
lwd = c(1.5, 2, NA, 2, NA, 2),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640", NA),
pt.cex = c(1, NA, 2, NA, 2, NA),
bty = 'n')
legend("topleft",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval"),
col = c("black", myblue, myblue, myred, myred),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640"),
pch = c(21, NA, 22, NA, 22),
lty = c(NA, 1, NA, 1, NA),
lwd = c(1.5, 2, NA, 2, NA),
bty = 'n',
pt.cex = c(1, NA, 2, NA, 2),
inset = c(0.01, -0.01))
legend('bottomright',
legend="A",
bty = 'n',
cex =1.2,
inset = c(0, -0.01))
### Return level plot
return_level_basic(coredata(year.res.max),
10^4, legend = FALSE,
ylim = c(200, 1000),
xlab = "",
xaxs = 'i', yaxs='i',
yaxt =  'n')
axis(2, at = seq(200, 2600, by = 200), labels = seq(2, 26, by = 2), lwd = 1.5, las = 1)
mtext("Return Period [years]", line = 2.5, side = 1)
#polygon(x = c(2:10000, 10000:2), y = c(MC_rl_max2[2:10000], rev(MC_rl_min2[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.35))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.55))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.25))
polygon(x = c(2:10000, 10000:2), y = c(year.return[,3], rev(year.return[,1])), col = "#0080FF40", border = NA)
polygon(x = c(2:10000, 10000:2), y = c(upper.90[2:10000], rev(lower.90[2:10000])), border = NA , col = "#FF666640")
lines(MC_rl_mean2, lwd = 2, lty = 1, col = myred)
#lines(x = c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000)), upper.95[c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000))], lty =2, col = "black")
#lines(x = c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000)), lower.95[c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000))], lty =2, col = "black")
legend("topleft",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval"),
col = c("black", myblue, myblue, myred, myred),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640"),
pch = c(21, NA, 22, NA, 22),
lty = c(NA, 1, NA, 1, NA),
lwd = c(1.5, 2, NA, 2, NA),
bty = 'n',
pt.cex = c(1, NA, 2, NA, 2),
inset = c(0.01, -0.01))
box(lwd = 1.5)
legend('bottomright',
legend="B",
bty = 'n',
cex=1.2,
inset = c(0, -0.01))
dev.off()
pdf("Figures/fig2.return_levels.pdf", width = 6, height = 7.5)
par(oma = c(0,0,0,0)+0.1, mar = c(4,4,1,1), mfrow = c(2,1))
plot.sf(coredata(year.res.max), pch = 21, bg = "white", lwd = 1.5,
ylab = "Exceedance Probability",
xlab = "",
yaxt = 'n', yaxs = 'i',
xaxt = 'n',
ylim = c(10^-4, 10^0+0.5),
xlim = c(200, 1000))
mtext("Return Level [meters]", line = 2.5, side = 1)
axis(1, at = seq(200, 2400, by = 200), labels = seq(2, 24, by = 2), lwd = 1.5, las = 1)
polygon(x = c(rev(upper_full.90[2:10000]), (lower_full.90[2:10000])), y = c(rev(1-q[2:10000]), (1-q[2:10000])), border = NA , col = "#FF666640")
polygon(x = c(rev(year.return[,3]), (year.return[,1])), y = c(rev(1/(2:10000)), 1/(2:10000)), border = NA, col = "#0080FF40")
lines(fit_q_year, 1-q, type="l",col=myblue, lwd=2)
lines(MC_full_mean[1:10000], 1-q, col = myred, lwd = 2)
abline(year.res.line, lwd = 1.5, lty = 2)
axis(2, lwd = 1.5, at=10^(seq(-6, -3, by = 1)), label=parse(text=paste("10^", seq(-6,-3, by = 1), sep="")), las = 1)
box(lwd = 1.5)
legend("topright",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval", "Linear Fit [van Dantzig (1956)]"),
col = c("black", myblue, myblue, myred, myred, "black"),
pch = c(21, NA, 22, NA, 22, NA),
lty = c(NA, 1, NA, 1, NA, 2),
lwd = c(1.5, 2, NA, 2, NA, 2),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640", NA),
pt.cex = c(1, NA, 2, NA, 2, NA),
bty = 'n')
legend('bottomright',
legend="A",
bty = 'n',
cex =1.2,
inset = c(0, -0.01))
### Return level plot
return_level_basic(coredata(year.res.max),
10^4, legend = FALSE,
ylim = c(200, 1000),
xlab = "",
xaxs = 'i', yaxs='i',
yaxt =  'n')
axis(2, at = seq(200, 2600, by = 200), labels = seq(2, 26, by = 2), lwd = 1.5, las = 1)
mtext("Return Period [years]", line = 2.5, side = 1)
#polygon(x = c(2:10000, 10000:2), y = c(MC_rl_max2[2:10000], rev(MC_rl_min2[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.35))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.55))
#polygon(x = c(2:10000, 10000:2), y = c(upper.95[2:10000], rev(lower.95[2:10000])), border = NA , col = rgb(200/255, 200/255, 200/255, 0.25))
polygon(x = c(2:10000, 10000:2), y = c(year.return[,3], rev(year.return[,1])), col = "#0080FF40", border = NA)
polygon(x = c(2:10000, 10000:2), y = c(upper.90[2:10000], rev(lower.90[2:10000])), border = NA , col = "#FF666640")
lines(MC_rl_mean2, lwd = 2, lty = 1, col = myred)
#lines(x = c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000)), upper.95[c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000))], lty =2, col = "black")
#lines(x = c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000)), lower.95[c(seq(1, 10, 1,), seq(100, 1000, 10), seq(1000, 10000, 1000))], lty =2, col = "black")
legend("topleft",
c("Block maxima observations", "Maximum Likelihood Estimation", "90% Confidence Interval", "MCMC Expected", "90% Credible Interval"),
col = c("black", myblue, myblue, myred, myred),
pt.bg = c("white", NA, "#0080FF40", NA, "#FF666640"),
pch = c(21, NA, 22, NA, 22),
lty = c(NA, 1, NA, 1, NA),
lwd = c(1.5, 2, NA, 2, NA),
bty = 'n',
pt.cex = c(1, NA, 2, NA, 2),
inset = c(0.01, -0.01))
box(lwd = 1.5)
legend('bottomright',
legend="B",
bty = 'n',
cex=1.2,
inset = c(0, -0.01))
dev.off()
setwd("~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison")
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
plot(X, (NPV_expected_losses.base/1e+06), type = 'l', col = myred,
xlab = NA,
ylab = expression(bold('Expected cost [million Guilders]')),
lwd = 3,
las = 1,
ylim = c(0,600),
xaxs="i",
xaxt='n')
lines(X, (costs.base/1e+06), col = myblue , lwd = 3)
lines(X, (total_costs.base/1e+06), col = 'black', lwd = 4)
points(min_cost_X, (total_costs.base[min_ind]/1e+06), pch = 19)
axis(side = 1, tck = -.045, labels = NA, lwd = 1.5)
axis(side = 2, tck = -.045, labels = NA, lwd = 1.5)
mtext(expression(bold('Expected cost')), side = 2, line = 3.5)
mtext('[million Guilders]', side = 2, line = 2.5)
legend("topright",
lty = c(1, 1, 1, NA),
pch = c(NA, NA, NA, 20),
lwd = 3,
c("Expected Losses", "Investment Costs", "Expected Total Costs", "Minimum Total Costs"),
col = c(myred, myblue, "black", "black"),
cex = 1,
bg = "white")
box(lwd = 1.3)
mtext("A. van Dantzig (1956) structure - only storm surge uncertainty", side = 3, line = 0.35, at = 0, adj = c(0,0), cex = 0.85)
mtext("A. van Dantzig (1956) structure - only storm surge uncertainty", side = 3, line = 0.3, at = 0, adj = c(0,0), cex = 0.85)
mtext("A. van Dantzig (1956) structure - only storm surge uncertainty", side = 3, line = 0.2, at = 0, adj = c(0,0), cex = 0.85)
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
?png
source('~/Documents/Grad/SCRiM/vanDantzig/Model_Versions/Uncertainty_SLR_GEV/Figures/Comparison/Baseline_Uncertainty_SLR_GEV.R', echo=TRUE)
?rep
rep(10,0, 1)
rep(c(10,0), 1)
rep(c(10,0)
)
rep(c(10,0), 5)
rep(c(10,0),5)
